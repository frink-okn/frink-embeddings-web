<div id="errors" class="alert" role="alert" hx-swap-oob="true">{% if error %}{{ error }}{% endif %}</div>

{% if results and results|length > 0 %}
<div id="results-pagination" class="pagination" hx-swap-oob="true">
  <button
    class="submit-req"
    hx-post="{{ url_for('web.post_query_view') }}"
    hx-target="#results"
    hx-target-error="#errors"
    hx-disabled-elt=".submit-req"
    hx-include=".query-form"
    hx-indicator=".query-form"
    hx-on:htmx-config-request="Frink.updateQueryParams()"
    hx-vals='{ "offset": {{ query.offset - query.limit if query.offset >= query.limit else 0 }} }'
    {% if query.offset == 0 %}disabled{% endif %}
  >
    Prev
  </button>
  <button
    class="submit-req"
    hx-post="{{ url_for('web.post_query_view') }}"
    hx-target="#results"
    hx-target-error="#errors"
    hx-disabled-elt=".submit-req"
    hx-include=".query-form"
    hx-indicator=".query-form"
    hx-on:htmx-config-request="Frink.updateQueryParams()"
    hx-vals='{ "offset": {{ query.offset + query.limit }} }'
  >
    Next
  </button>
</div>

<div class="results-body">
  <div class="table-wrap">
    <table class="results-table">
      <thead>
        <tr>
          <th>URI</th>
          <th>Label</th>
          <th>Graph</th>
          <th>Match Score</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
      {% for r in results %}
        <tr>
          <td>
            {% if r.payload.iri %}
              <div class="uri-cell">
                <a class="mono" href="{{ r.payload.iri }}" target="_blank" rel="noreferrer" title="{{ r.payload.iri }}">open</a>
                <button type="button" class="copy-btn" data-copy="{{ r.payload.iri }}" aria-label="Copy node URI">Copy</button>
              </div>
            {% endif %}
          </td>
          <td class="label-main" title="{{ r.payload.label or '' }}">{{ r.payload.label or "" }}</td>
          <td title="{{ r.payload.graph or '' }}">{{ r.payload.graph or "" }}</td>
          <td>
            {% if r.score is not none %}
              {{ '%.4f' | format(r.score) }}
            {% else %}
              {{ "" }}
            {% endif %}
          </td>
          <td>
            <a
              href="https://frink.apps.renci.org/term/{{ r.encoded_uri }}"
              target="_blank"
              rel="noreferrer"
            >
              Details
            </a>
          </td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% else %}
<div id="results-pagination" hx-swap-oob="true"></div>
<p>No results.</p>
{% endif %}
